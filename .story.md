---
focus: src/main/java/bowling/Game.java
---
## Fixing strike calculation

The issue was with the bonus calculation for strikes.
Note, the [two final test cases](src/test/java/bowling/GameTest.java:92-107) in the `GameTest` class,
that tries to highlight the issue.

For understanding the flaws of implementation we have to go to the `IntermediateFrame` 
[declaration](src/main/java/bowling/IntermediateFrame.java:11:old) and see the old implementation.

In case of strikes the second roll will be 0 in all cases. This will not add the appropriate value
for the second roll in cases, when we have reach out to the **next frame** for the appropriate value.

Let's introduce the `getSecondRollForBonus` method [inside the](src/main/java/bowling/Frame.java) `Frame` class.
The modified [score calculation](src/main/java/bowling/IntermediateFrame.java:30) 
can use this method to determine the appropriate score in case of strike bonus.

See [the implementation](src/main/java/bowling/IntermediateFrame.java:39) inside `IntermediateFrame`
that now clearly explains, that we have to reach out to the next frame's first roll if we had a strike.

In the `FinalFrame` we [just simply](src/main/java/bowling/FinalFrame.java:53) always return
the second roll.

There was also several mistakes in the `FinalFrame` implementation.
I had to [change the tests](src/test/java/bowling/FinalFrameTest.java:65) to reveal that.
With a strike, we have to allow three rolls. Even, when the second one was not knocking down all the pins.

After the implementation [follows](src/main/java/bowling/FinalFrame.java) the changes, tests are
green. 


Eventually, there were some additional refactoring made, like removing the 
[roll](src/main/java/bowling/BaseFrame.java:22) implementation from `BaseFrame`,
or extracting and moving up the [verification of](src/main/java/bowling/BaseFrame.java:42) the number of pins rolled by each player.
